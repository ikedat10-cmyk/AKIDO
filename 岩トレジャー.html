<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #a7c598; -webkit-text-stroke: #a7c598}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #36c0a0; -webkit-text-stroke: #36c0a0}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s8 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s9 {font-kerning: none; color: #6d7378; background-color: #171818; -webkit-text-stroke: 0px #6d7378}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s12 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s13 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
    span.s14 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s15 {font-kerning: none; color: #a34f83; background-color: #171818; -webkit-text-stroke: 0px #a34f83}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"ja"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">トレジャークリフ - 投石大富豪</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">@import</span><span class="s4"> </span><span class="s5">url</span><span class="s8">(</span><span class="s1">'https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@700;800&amp;family=Zen+Maru+Gothic:wght@500;700;900&amp;display=swap'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">font-family:</span><span class="s4"> </span><span class="s1">'Zen Maru Gothic'</span><span class="s8">,</span><span class="s4"> </span><span class="s5">sans-serif</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #1a1510</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">color:</span><span class="s1"> #e2e8f0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">user-select:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">-webkit-user-select:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">overflow:</span><span class="s1"> </span><span class="s5">hidden</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">touch-action:</span><span class="s1"> </span><span class="s5">manipulation</span><span class="s8">;</span><span class="s1"> </span><span class="s9">/* ズーム防止 */</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">-webkit-tap-highlight-color:</span><span class="s4"> </span><span class="s5">transparent</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.font-serif</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">font-family:</span><span class="s4"> </span><span class="s1">'Shippori Mincho'</span><span class="s8">,</span><span class="s4"> </span><span class="s5">serif</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.bg-cave</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> </span><span class="s5">radial-gradient(circle</span><span class="s1"> </span><span class="s5">at</span><span class="s1"> </span><span class="s5">center</span><span class="s1"> </span><span class="s5">top</span><span class="s8">,</span><span class="s1"> #2d241e </span><span class="s11">0%</span><span class="s8">,</span><span class="s1"> #0f0b09 </span><span class="s11">100%</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* 岩エリア */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.cliff-container</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">relative</span><span class="s8">;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s4"> </span><span class="s11">260px</span><span class="s8">;</span><span class="s4"> </span><span class="s1">/* スマホ向けに少し小さく */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s11">260px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin:</span><span class="s1"> </span><span class="s11">0</span><span class="s1"> </span><span class="s5">auto</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">transform-origin:</span><span class="s4"> </span><span class="s5">bottom</span><span class="s4"> </span><span class="s5">center</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s11">10</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.cliff-container:active</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s5">scale(</span><span class="s11">0.98</span><span class="s5">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.cliff-svg</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">filter:</span><span class="s4"> </span><span class="s1">drop-shadow(</span><span class="s11">0</span><span class="s4"> </span><span class="s11">10px</span><span class="s4"> </span><span class="s11">20px</span><span class="s4"> </span><span class="s1">rgba(</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0.8</span><span class="s1">))</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">filter</span><span class="s1"> </span><span class="s11">0.1s</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* アニメーション定義 */</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">@keyframes</span><span class="s1"> </span><span class="s5">shake</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">0%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">1px</span><span class="s8">,</span><span class="s4"> </span><span class="s11">1px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">0deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">20%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">-3px</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">1deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">40%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">1px</span><span class="s8">,</span><span class="s4"> </span><span class="s11">-1px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">1deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">60%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">-3px</span><span class="s8">,</span><span class="s4"> </span><span class="s11">1px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">0deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">80%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">-1px</span><span class="s8">,</span><span class="s4"> </span><span class="s11">-1px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">1deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">100%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translate(</span><span class="s11">0</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">0</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.shake</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">animation:</span><span class="s1"> </span><span class="s5">shake</span><span class="s1"> </span><span class="s11">0.15s</span><span class="s1"> </span><span class="s5">ease-out</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">@keyframes</span><span class="s4"> </span><span class="s1">screen-shake</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">0%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">0</span><span class="s8">,</span><span class="s1"> </span><span class="s11">0</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">20%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">-5px</span><span class="s8">,</span><span class="s1"> </span><span class="s11">5px</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">40%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">5px</span><span class="s8">,</span><span class="s1"> </span><span class="s11">-5px</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">60%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">-3px</span><span class="s8">,</span><span class="s1"> </span><span class="s11">3px</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">80%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">2px</span><span class="s8">,</span><span class="s1"> </span><span class="s11">-2px</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">100%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">0</span><span class="s8">,</span><span class="s1"> </span><span class="s11">0</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.screen-shake</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">animation:</span><span class="s4"> </span><span class="s1">screen-shake</span><span class="s4"> </span><span class="s11">0.4s</span><span class="s4"> </span><span class="s1">ease-out</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">@keyframes</span><span class="s1"> </span><span class="s5">crumbling</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">0%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translateY(</span><span class="s11">0</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">0deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s2">opacity:</span><span class="s4"> </span><span class="s11">1</span><span class="s8">;</span><span class="s4"> </span><span class="s2">filter:</span><span class="s4"> </span><span class="s1">blur(</span><span class="s11">0</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">15%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translateY(</span><span class="s11">10px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">-5deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s2">opacity:</span><span class="s4"> </span><span class="s11">1</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">100%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translateY(</span><span class="s11">500px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">rotate(</span><span class="s11">45deg</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s2">opacity:</span><span class="s4"> </span><span class="s11">0</span><span class="s8">;</span><span class="s4"> </span><span class="s2">filter:</span><span class="s4"> </span><span class="s1">blur(</span><span class="s11">4px</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.crumbling</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">animation:</span><span class="s4"> </span><span class="s1">crumbling</span><span class="s4"> </span><span class="s11">1.0s</span><span class="s4"> </span><span class="s1">forwards</span><span class="s4"> </span><span class="s1">cubic-bezier(</span><span class="s11">0.55</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0.055</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0.675</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0.19</span><span class="s1">)</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">@keyframes</span><span class="s1"> </span><span class="s5">popIn</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">0%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s11">200px</span><span class="s5">)</span><span class="s1"> </span><span class="s5">scale(</span><span class="s11">0.8</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s2">opacity:</span><span class="s1"> </span><span class="s11">0</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">60%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s11">-10px</span><span class="s5">)</span><span class="s1"> </span><span class="s5">scale(</span><span class="s11">1.05</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s2">opacity:</span><span class="s1"> </span><span class="s11">1</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s11">80%</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transform:</span><span class="s4"> </span><span class="s1">translateY(</span><span class="s11">5px</span><span class="s1">)</span><span class="s4"> </span><span class="s1">scale(</span><span class="s11">0.95</span><span class="s1">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s11">100%</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translateY(</span><span class="s11">0</span><span class="s5">)</span><span class="s1"> </span><span class="s5">scale(</span><span class="s11">1</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s2">opacity:</span><span class="s1"> </span><span class="s11">1</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.pop-in</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">animation:</span><span class="s4"> </span><span class="s5">popIn</span><span class="s4"> </span><span class="s1">0.5s</span><span class="s4"> </span><span class="s5">cubic-bezier(</span><span class="s1">0.175</span><span class="s8">,</span><span class="s4"> </span><span class="s1">0.885</span><span class="s8">,</span><span class="s4"> </span><span class="s1">0.32</span><span class="s8">,</span><span class="s4"> </span><span class="s1">1.275</span><span class="s5">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.stone-projectile</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">fixed</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s11">20px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s11">20px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #a8a29e</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s11">40%</span><span class="s8">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s4"> </span><span class="s5">inset</span><span class="s4"> </span><span class="s1">-2px</span><span class="s4"> </span><span class="s1">-2px</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0.5</span><span class="s5">)</span><span class="s8">,</span><span class="s4"> </span><span class="s1">2px</span><span class="s4"> </span><span class="s1">2px</span><span class="s4"> </span><span class="s1">4px</span><span class="s4"> </span><span class="s5">rgba(</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0</span><span class="s8">,</span><span class="s1">0.3</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s11">50</span><span class="s8">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">will-change:</span><span class="s4"> </span><span class="s1">transform</span><span class="s8">,</span><span class="s4"> </span><span class="s1">left</span><span class="s8">,</span><span class="s4"> </span><span class="s1">top</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.particle</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">absolute</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s11">60</span><span class="s8">;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">will-change:</span><span class="s4"> </span><span class="s1">transform</span><span class="s8">,</span><span class="s4"> </span><span class="s1">opacity</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.rubble</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">absolute</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> #5d4037</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s11">4px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">box-shadow:</span><span class="s1"> </span><span class="s11">2px</span><span class="s1"> </span><span class="s11">2px</span><span class="s1"> </span><span class="s11">4px</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0</span><span class="s8">,</span><span class="s11">0.5</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">z-index:</span><span class="s1"> </span><span class="s11">40</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* スクロールバー調整 */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.custom-scroll::-webkit-scrollbar</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">width:</span><span class="s4"> </span><span class="s11">4px</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.custom-scroll::-webkit-scrollbar-track</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">background:</span><span class="s4"> #1e1814</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.custom-scroll::-webkit-scrollbar-thumb</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">background:</span><span class="s4"> #5c4838</span><span class="s8">;</span><span class="s4"> </span><span class="s2">border-radius:</span><span class="s4"> </span><span class="s11">2px</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* トースト通知 */</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">@keyframes</span><span class="s4"> </span><span class="s1">slideInDown</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s5">from</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">-50%</span><span class="s8">,</span><span class="s1"> </span><span class="s11">-100%</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s2">opacity:</span><span class="s1"> </span><span class="s11">0</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s5">to</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">translate(</span><span class="s11">-50%</span><span class="s8">,</span><span class="s1"> </span><span class="s11">0</span><span class="s5">)</span><span class="s8">;</span><span class="s1"> </span><span class="s2">opacity:</span><span class="s1"> </span><span class="s11">1</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.toast</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s2">animation:</span><span class="s4"> </span><span class="s1">slideInDown</span><span class="s4"> </span><span class="s11">0.4s</span><span class="s4"> </span><span class="s1">cubic-bezier(</span><span class="s11">0.68</span><span class="s8">,</span><span class="s4"> </span><span class="s11">-0.55</span><span class="s8">,</span><span class="s4"> </span><span class="s11">0.27</span><span class="s8">,</span><span class="s4"> </span><span class="s11">1.55</span><span class="s1">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.hp-bar-container</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">width:</span><span class="s1"> </span><span class="s11">160px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s11">8px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> #000</span><span class="s8">;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">border-radius:</span><span class="s4"> </span><span class="s11">4px</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">margin:</span><span class="s1"> </span><span class="s11">0</span><span class="s1"> </span><span class="s5">auto</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">overflow:</span><span class="s1"> </span><span class="s5">hidden</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">border:</span><span class="s1"> </span><span class="s11">1px</span><span class="s1"> </span><span class="s5">solid</span><span class="s1"> #444</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">position:</span><span class="s1"> </span><span class="s5">relative</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.hp-bar-fill</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">height:</span><span class="s1"> </span><span class="s11">100%</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background:</span><span class="s1"> </span><span class="s5">linear-gradient(</span><span class="s11">90deg</span><span class="s8">,</span><span class="s1"> #ef4444</span><span class="s8">,</span><span class="s1"> #f87171</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transition:</span><span class="s1"> </span><span class="s5">width</span><span class="s1"> </span><span class="s11">0.1s</span><span class="s1"> </span><span class="s5">linear</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">/* スマホ向けボタン調整 */</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.tap-active:active</span><span class="s4"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s1"> </span><span class="s5">rgba(</span><span class="s11">255</span><span class="s8">,</span><span class="s1"> </span><span class="s11">255</span><span class="s8">,</span><span class="s1"> </span><span class="s11">255</span><span class="s8">,</span><span class="s1"> </span><span class="s11">0.1</span><span class="s5">)</span><span class="s1"> </span><span class="s7">!important</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s2">transform:</span><span class="s1"> </span><span class="s5">scale(</span><span class="s11">0.98</span><span class="s5">)</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"game-body"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-screen w-screen flex flex-col bg-cave overflow-hidden text-sm md:text-base"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Header: コンパクトに --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">header</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-black/60 backdrop-blur border-b border-orange-900/30 px-3 py-2 shrink-0 z-30 shadow-lg flex justify-between items-center h-14"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Money --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex flex-col justify-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex items-baseline gap-1"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"money-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl font-mono font-black text-yellow-400 tracking-tighter drop-shadow-md leading-none"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xs text-yellow-600 font-bold"</span><span class="s3">&gt;</span><span class="s4">G</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-[10px] text-orange-100/50 font-mono leading-none mt-0.5"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>+</span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"gps-display"</span><span class="s3">&gt;</span><span class="s1">0</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> G/秒</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Title &amp; Rank --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-1 px-4 text-center"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">             </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"title-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-sm md:text-lg font-serif font-bold text-white truncate drop-shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>落ち金拾い</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Progress --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full max-w-[120px] mx-auto h-1.5 bg-black/50 rounded-full mt-1 overflow-hidden relative border border-white/10"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"progress-bar"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-full bg-gradient-to-r from-yellow-700 to-yellow-400 transition-all duration-300"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"width: 0%"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Menu Button (Save/Reset) --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.toggleMenu()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"p-2 text-slate-400 hover:text-white"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">svg</span><span class="s4"> </span><span class="s2">xmlns</span><span class="s3">=</span><span class="s1">"http://www.w3.org/2000/svg"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"h-5 w-5"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"none"</span><span class="s4"> </span><span class="s2">viewBox</span><span class="s3">=</span><span class="s1">"0 0 24 24"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"currentColor"</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s1">stroke-linecap</span><span class="s3">=</span><span class="s5">"round"</span><span class="s4"> </span><span class="s1">stroke-linejoin</span><span class="s3">=</span><span class="s5">"round"</span><span class="s4"> </span><span class="s1">stroke-width</span><span class="s3">=</span><span class="s5">"2"</span><span class="s4"> </span><span class="s1">d</span><span class="s3">=</span><span class="s5">"M4 6h16M4 12h16M4 18h16"</span><span class="s4"> </span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">svg</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">header</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Main Game Area --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-1 flex flex-col relative overflow-hidden"</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Top Half: Action Area (岩) --&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- pointer-events-auto でここをタップエリアにする --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">section</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"click-area"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"relative flex-grow flex flex-col items-center justify-center z-10 touch-none"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- HP &amp; Info --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"hp-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"absolute top-4 left-0 right-0 text-center opacity-90 transition-opacity select-none pointer-events-none z-20"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hp-bar-container mb-1"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"cliff-hp-bar"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hp-bar-fill"</span><span class="s4"> </span><span class="s2">style</span><span class="s3">=</span><span class="s1">"width: 100%"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-[10px] font-mono text-slate-400 shadow-black drop-shadow-md"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>HP: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"hp-text"</span><span class="s3">&gt;</span><span class="s1">100</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s1"> / </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"max-hp-text"</span><span class="s3">&gt;</span><span class="s1">100</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- The Cliff --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"relative w-full h-full flex items-center justify-center pb-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"cliff-target"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"cliff-container pointer-events-none"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">svg</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"cliff-svg w-full h-full"</span><span class="s4"> </span><span class="s2">viewBox</span><span class="s3">=</span><span class="s1">"0 0 200 200"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"none"</span><span class="s4"> </span><span class="s2">xmlns</span><span class="s3">=</span><span class="s1">"http://www.w3.org/2000/svg"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"rock-path"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M40 160L20 100L50 40L100 20L160 30L190 90L170 150L110 180L40 160Z"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"#5D4037"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#3E2723"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"4"</span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">&lt;!-- Detail Layers --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M50 40L100 20L110 60L50 40Z"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"#795548"</span><span class="s4"> </span><span class="s2">opacity</span><span class="s3">=</span><span class="s1">"0.5"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M160 30L190 90L150 100L160 30Z"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"#8D6E63"</span><span class="s4"> </span><span class="s2">opacity</span><span class="s3">=</span><span class="s1">"0.5"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M40 160L110 180L100 130L40 160Z"</span><span class="s4"> </span><span class="s2">fill</span><span class="s3">=</span><span class="s1">"#4E342E"</span><span class="s4"> </span><span class="s2">opacity</span><span class="s3">=</span><span class="s1">"0.5"</span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">&lt;!-- Cracks --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"crack-1"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M100 20L100 80"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#110a05"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"3"</span><span class="s4"> </span><span class="s2">stroke-linecap</span><span class="s3">=</span><span class="s1">"round"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-0 transition-opacity duration-200"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"crack-2"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M50 40L90 90"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#110a05"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"3"</span><span class="s4"> </span><span class="s2">stroke-linecap</span><span class="s3">=</span><span class="s1">"round"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-0 transition-opacity duration-200"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"crack-3"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M160 30L120 80"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#110a05"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"3"</span><span class="s4"> </span><span class="s2">stroke-linecap</span><span class="s3">=</span><span class="s1">"round"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-0 transition-opacity duration-200"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"crack-4"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M20 100L180 120"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#000"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"2"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-0 transition-opacity duration-100"</span><span class="s3">/&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">path</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"crack-5"</span><span class="s4"> </span><span class="s2">d</span><span class="s3">=</span><span class="s1">"M110 180L110 20"</span><span class="s4"> </span><span class="s2">stroke</span><span class="s3">=</span><span class="s1">"#000"</span><span class="s4"> </span><span class="s2">stroke-width</span><span class="s3">=</span><span class="s1">"2"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"opacity-0 transition-opacity duration-100"</span><span class="s3">/&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">svg</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Tap Hint --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"absolute bottom-4 left-0 right-0 text-center pointer-events-none opacity-60"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"inline-flex items-center gap-1.5 px-3 py-1 bg-black/40 rounded-full border border-white/10 backdrop-blur-sm"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">span</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-lg"</span><span class="s3">&gt;</span><span class="s1">🪨</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-[10px] text-slate-300"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span>威力: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"cpc-display"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"font-bold text-orange-400 font-mono"</span><span class="s3">&gt;</span><span class="s4">10</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Effects Layer --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"click-effects"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"absolute inset-0 pointer-events-none z-50"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">section</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- Bottom Half: Shop &amp; Menu --&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;!-- 高さ固定ではなく flex で配分、最低高さを確保 --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">aside</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-[#1e1814] border-t border-orange-900/30 flex flex-col h-[45%] shadow-[0_-4px_20px_rgba(0,0,0,0.5)] z-20"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Tabs --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex border-b border-orange-900/30 shrink-0"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"tab-upgrade"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.switchTab('upgrade')"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-1 py-3 text-xs md:text-sm font-bold text-orange-400 border-b-2 border-orange-500 bg-black/20 tap-active"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>強化ショップ</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"tab-history"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.switchTab('history')"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-1 py-3 text-xs md:text-sm font-bold text-slate-500 border-b-2 border-transparent hover:bg-white/5 tap-active"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>称号リスト</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;!-- Content Area --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"flex-1 overflow-y-auto custom-scroll p-2 pb-safe"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"shop-container"</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">&lt;!-- Upgrades will be here --&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden flex-1 overflow-y-auto custom-scroll p-2 pb-safe"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"history-container"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s3">&lt;</span><span class="s6">table</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full text-left text-xs text-slate-400"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">tbody</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"history-list"</span><span class="s3">&gt;&lt;/</span><span class="s6">tbody</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">table</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">aside</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Toast Notification (Center Top for Mobile) --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"toast-container"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"fixed top-16 left-1/2 -translate-x-1/2 z-50 flex flex-col gap-2 pointer-events-none w-[90%] max-w-sm"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;!-- Menu Modal --&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"menu-modal"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"hidden fixed inset-0 z-[60] bg-black/90 backdrop-blur-sm flex items-center justify-center p-6"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.toggleMenu()"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-[#2d241e] border border-orange-900/50 rounded-xl p-6 w-full max-w-sm space-y-4 shadow-2xl"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"event.stopPropagation()"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h3</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-xl font-bold text-orange-400 text-center mb-4"</span><span class="s3">&gt;</span><span class="s4">メニュー</span><span class="s3">&lt;/</span><span class="s6">h3</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-3"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-center text-xs text-slate-400"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                    </span>第</span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"menu-chapter"</span><span class="s3">&gt;</span><span class="s4">1</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span><span class="s4">章: </span><span class="s3">&lt;</span><span class="s6">span</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"menu-title"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-white font-bold"</span><span class="s3">&gt;</span><span class="s4">称号</span><span class="s3">&lt;/</span><span class="s6">span</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.resetSave()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full py-3 bg-red-900/30 border border-red-800 text-red-200 rounded-lg active:scale-95 transition-transform"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>データを初期化して最初から</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"game.toggleMenu()"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full py-3 bg-slate-700 text-white rounded-lg active:scale-95 transition-transform"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>閉じる</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Data Definitions ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> </span><span class="s12">CHAPTERS</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"第1章：幸運の始まり"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第2章：街一番の富豪"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第3章：黄金の魔力"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第4章：国家を揺らす富"</span><span class="s8">,</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"第5章：大陸の覇権"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第6章：伝説の富"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第7章：異次元の財力"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第8章：富の化身"</span><span class="s8">,</span><span class="s4"><span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"第9章：世界の真理"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"第10章：究極の称号"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> </span><span class="s12">TITLES_RAW</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"落ち金拾い"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"小銭の収集家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"臨時収入の寵児"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"財布の膨らんだ男（女）"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"銅貨の支配者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"日銭の魔術師"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"質屋の上客"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"銀貨の予感"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"幸運の端くれ"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】路地の成金"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"蓄財の初級者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"蔵の番人"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"街角のスポンサー"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"利子の収穫者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"銀貨の蒐集家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"商店街の顔役"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"投資の先駆者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"金脈の探求者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の卵を持つ者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】地方の有力者"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"豪商の卵"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"金貨の雨を降らす者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"贅沢の門下生"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"競売場の支配者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"貨幣の鑑定士"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"成金男爵"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の審美眼"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"資産の防衛者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"銀行の最優先顧客"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】黄金の若獅子"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"王都の資金源"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"独占の狩人"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"流通の覇者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金を産む指先"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"国債の引受人"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"経済の調律師"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"豪華絢爛なパトロン"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"札束の城主"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"欲望の体現者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】国家の財政顧問"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"無尽蔵の金庫番"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"通貨の破壊者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"大陸横断の富豪"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の航路主"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"価値の創造者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"不動産の王"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"市場の独裁者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"錬金術の体現者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の執政官"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】世界銀行の影"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"伝説の出資者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金郷の再来"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"貴金属の化身"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"富の歴史家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"滅びぬ資産家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"ダイヤモンドの心臓"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"聖なる投資家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"貨幣制度の父"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の凱旋門"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】人類至上の富豪"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"惑星の買い手"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"経済の神託者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"永遠の利権保持者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の設計者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"市場の超越者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"運命の出資家"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"富の独占禁止法"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"概念の所有者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の終焉"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】経済の特異点"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"黄金の胎動"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"万物の価値を決める者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"富の源泉"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"欲望の統治者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"無限の貯蔵庫"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の審判を下す者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"至福の支配者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"貨幣の守護神"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"富と名声の結晶"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】黄金王"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"唯一無二の資産"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の理（ことわり）"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"世界を買い叩く者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"経済の法則"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"虚空から金を産む者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"真理のスポンサー"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"神々の融資者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"宇宙の負債者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"永遠の黄金時代"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【昇格】天上の大富豪"</span><span class="s8">,</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">"存在が金なり"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"万物の所有者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の創造主"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"富の特異点"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"終焉なき繁栄"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"全能の財力"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"運命の買い手"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"黄金の因果"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"宇宙の主権者"</span><span class="s8">,</span><span class="s4"> </span><span class="s1">"【最終称号】ミダス（黄金神）"</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">];</span></p>
<p class="p9"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s4"> </span><span class="s1">TITLE_DATA</span><span class="s4"> </span><span class="s8">=</span><span class="s4"> </span><span class="s1">TITLES_RAW</span><span class="s8">.</span><span class="s4">map</span><span class="s8">((</span><span class="s4">t</span><span class="s8">,</span><span class="s4"> i</span><span class="s8">)</span><span class="s4"> </span><span class="s8">=&gt;</span><span class="s4"> </span><span class="s8">({</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>id</span><span class="s8">:</span><span class="s1"> i</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>title</span><span class="s8">:</span><span class="s1"> t</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>threshold</span><span class="s8">:</span><span class="s1"> i </span><span class="s8">*</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>chapter</span><span class="s8">:</span><span class="s1"> </span><span class="s12">CHAPTERS</span><span class="s8">[</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s1">i </span><span class="s8">/</span><span class="s1"> </span><span class="s13">10</span><span class="s8">)],</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>isPromotion</span><span class="s8">:</span><span class="s1"> t</span><span class="s8">.</span><span class="s1">includes</span><span class="s8">(</span><span class="s14">"【"</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> i </span><span class="s8">===</span><span class="s1"> </span><span class="s12">TITLES_RAW</span><span class="s8">.</span><span class="s1">length </span><span class="s8">-</span><span class="s1"> </span><span class="s13">1</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}));</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> </span><span class="s12">UPGRADES</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"tool1"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"手頃な石"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"click"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">100</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">5</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"その辺の石ころ"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto1"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"いたずら小僧"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">500</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">10</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"自動で石を投げる"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"tool2"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"パチンコ"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"click"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1500</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">20</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"ゴムの力で威力倍増"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto2"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"剛腕投手"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">3000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">50</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"160km/hの剛速球"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"tool3"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"バリスタ"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"click"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">8000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">100</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"巨大な矢と石を発射"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto3"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"自動投石機"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">15000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">200</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"一定間隔で石を放る"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"tool4"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"トレビュシェット"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"click"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">30000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">500</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"攻城兵器の王様"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto4"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"岩石大砲"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">60000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"火薬で岩を飛ばす"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"tool5"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"メテオコール"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"click"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">100000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">2000</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"隕石を呼び寄せる"</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">{</span><span class="s1"> id</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto5"</span><span class="s8">,</span><span class="s1"> name</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"重力カタパルト"</span><span class="s8">,</span><span class="s1"> type</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"auto"</span><span class="s8">,</span><span class="s1"> baseCost</span><span class="s8">:</span><span class="s1"> </span><span class="s13">200000</span><span class="s8">,</span><span class="s1"> basePower</span><span class="s8">:</span><span class="s1"> </span><span class="s13">5000</span><span class="s8">,</span><span class="s1"> desc</span><span class="s8">:</span><span class="s1"> </span><span class="s14">"重力で山を砕く"</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">];</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Game Logic ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">class</span><span class="s1"> </span><span class="s12">Game</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">constructor</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>money</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>maxMoney</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>cliffHP</span><span class="s8">:</span><span class="s1"> </span><span class="s13">100</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>cliffMaxHP</span><span class="s8">:</span><span class="s1"> </span><span class="s13">100</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>cliffLevel</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>upgrades</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{},</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>lastSaveTime</span><span class="s8">:</span><span class="s1"> </span><span class="s12">Date</span><span class="s8">.</span><span class="s1">now</span><span class="s8">()</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">]</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">load</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">initUI</span><span class="s8">();</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// Game Loop</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">loopId </span><span class="s8">=</span><span class="s1"> setInterval</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">loop</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">100</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">saveId </span><span class="s8">=</span><span class="s1"> setInterval</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">save</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">10000</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// Event Listeners</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">setupInput</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>setupInput</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> clickArea </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-area'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// マルチタッチ対応のため pointerdown を使用</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>clickArea</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s14">'pointerdown'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s1">// ショップ操作時は反応させない（念のため）</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">target</span><span class="s8">.</span><span class="s1">closest</span><span class="s8">(</span><span class="s14">'aside'</span><span class="s8">))</span><span class="s1"> </span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>e</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span><span class="s1"> </span><span class="s9">// デフォルトのタッチ挙動を無効化</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">handleTap</span><span class="s8">(</span><span class="s1">e</span><span class="s8">.</span><span class="s1">clientX</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">clientY</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">pointerId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>handleTap</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">,</span><span class="s1"> pointerId</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 投石アニメーションの起点: 画面下中央ではなく、タップ位置の少し下から</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// これにより指で隠れず、かつ「投げている」感が出る</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> startX </span><span class="s8">=</span><span class="s1"> window</span><span class="s8">.</span><span class="s1">innerWidth </span><span class="s8">/</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> startY </span><span class="s8">=</span><span class="s1"> window</span><span class="s8">.</span><span class="s1">innerHeight</span><span class="s8">;</span><span class="s1"> </span><span class="s9">// 画面最下部から</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnProjectile</span><span class="s8">(</span><span class="s1">startX</span><span class="s8">,</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">get</span><span class="s1"> clickPower</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> power </span><span class="s8">=</span><span class="s1"> </span><span class="s13">10</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">filter</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> u</span><span class="s8">.</span><span class="s1">type </span><span class="s8">===</span><span class="s1"> </span><span class="s14">'click'</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>power </span><span class="s8">+=</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">]</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> u</span><span class="s8">.</span><span class="s1">basePower</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s1"> power</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">get</span><span class="s1"> autoIncome</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> income </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">filter</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> u</span><span class="s8">.</span><span class="s1">type </span><span class="s8">===</span><span class="s1"> </span><span class="s14">'auto'</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>income </span><span class="s8">+=</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">]</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> u</span><span class="s8">.</span><span class="s1">basePower</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s1"> income</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getUpgradeCost</span><span class="s8">(</span><span class="s1">upgradeId</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> upgrade </span><span class="s8">=</span><span class="s1"> </span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">find</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> u</span><span class="s8">.</span><span class="s1">id </span><span class="s8">===</span><span class="s1"> upgradeId</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> level </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">upgradeId</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s1">upgrade</span><span class="s8">.</span><span class="s1">baseCost </span><span class="s8">*</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s13">1.5</span><span class="s8">,</span><span class="s1"> level</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnProjectile</span><span class="s8">(</span><span class="s1">startX</span><span class="s8">,</span><span class="s1"> startY</span><span class="s8">,</span><span class="s1"> endX</span><span class="s8">,</span><span class="s1"> endY</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> stone </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>stone</span><span class="s8">.</span><span class="s1">className </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'stone-projectile'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>stone</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> startX </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>stone</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> startY </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> rotation </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">360</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>stone</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">transform </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`translate(-50%, -50%) rotate(</span><span class="s8">${</span><span class="s1">rotation</span><span class="s8">}</span><span class="s14">deg)`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">body</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">stone</span><span class="s8">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// モバイル向けに少し高速化 (150ms -&gt; 120ms)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> anim </span><span class="s8">=</span><span class="s1"> stone</span><span class="s8">.</span><span class="s1">animate</span><span class="s8">([</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> left</span><span class="s8">:</span><span class="s1"> startX </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">,</span><span class="s1"> top</span><span class="s8">:</span><span class="s1"> startY </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">,</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(-50%, -50%) rotate(</span><span class="s8">${</span><span class="s1">rotation</span><span class="s8">}</span><span class="s14">deg) scale(0.5)`</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> left</span><span class="s8">:</span><span class="s1"> endX </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">,</span><span class="s1"> top</span><span class="s8">:</span><span class="s1"> endY </span><span class="s8">+</span><span class="s1"> </span><span class="s14">'px'</span><span class="s8">,</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(-50%, -50%) rotate(</span><span class="s8">${</span><span class="s1">rotation </span><span class="s8">+</span><span class="s1"> </span><span class="s13">180</span><span class="s8">}</span><span class="s14">deg) scale(1.0)`</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">],</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> duration</span><span class="s8">:</span><span class="s1"> </span><span class="s13">120</span><span class="s8">,</span><span class="s1"> easing</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'cubic-bezier(0.25, 1, 0.5, 1)'</span><span class="s1"> </span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>anim</span><span class="s8">.</span><span class="s1">onfinish </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>stone</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">impact</span><span class="s8">(</span><span class="s1">endX</span><span class="s8">,</span><span class="s1"> endY</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>impact</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> damageToRock </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s13">1</span><span class="s8">,</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">clickPower </span><span class="s8">/</span><span class="s1"> </span><span class="s13">5</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> goldGain </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">clickPower</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> cliffContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'cliff-target'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">contains</span><span class="s8">(</span><span class="s14">'crumbling'</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">-=</span><span class="s1"> damageToRock</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">addMoney</span><span class="s8">(</span><span class="s1">goldGain</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnParticles</span><span class="s8">(</span><span class="s1">goldGain</span><span class="s8">,</span><span class="s1"> x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnStoneFragments</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">);</span><span class="s1"> </span><span class="s9">// 細かい石</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// たまに大きな破片</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.3</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnBigFragment</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">animateCliff</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">&lt;=</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">!</span><span class="s1">cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">contains</span><span class="s8">(</span><span class="s14">'crumbling'</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">breakCliff</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">updateUI</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>breakCliff</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> bonus </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP </span><span class="s8">*</span><span class="s1"> </span><span class="s13">5</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">addMoney</span><span class="s8">(</span><span class="s1">bonus</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s4">showToast</span><span class="s8">(</span><span class="s1">`破壊ボーナス！&lt;br&gt;&lt;span class="text-yellow-300 font-bold"&gt;+</span><span class="s8">${</span><span class="s4">bonus</span><span class="s8">.</span><span class="s4">toLocaleString</span><span class="s8">()}</span><span class="s1"> G&lt;/span&gt;`</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'success'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnExplosion</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">spawnRubble</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">screenShake</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> cliffContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'cliff-target'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'shake'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'crumbling'</span><span class="s8">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'hp-container'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'0'</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffLevel</span><span class="s8">++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s13">100</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">pow</span><span class="s8">(</span><span class="s13">1.2</span><span class="s8">,</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffLevel </span><span class="s8">-</span><span class="s1"> </span><span class="s13">1</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'crumbling'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i</span><span class="s8">=</span><span class="s13">1</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">&lt;=</span><span class="s13">5</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> crack </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">`crack-</span><span class="s8">${</span><span class="s1">i</span><span class="s8">}</span><span class="s14">`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s8">(</span><span class="s1">crack</span><span class="s8">)</span><span class="s1"> crack</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'pop-in'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'hp-container'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'0.9'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> cliffContainer</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'pop-in'</span><span class="s8">),</span><span class="s1"> </span><span class="s13">500</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">},</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>animateCliff</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> cliff </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'cliff-target'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">cliff</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">contains</span><span class="s8">(</span><span class="s14">'crumbling'</span><span class="s8">))</span><span class="s1"> </span><span class="s7">return</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// CSS Animationのリセットハック</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>cliff</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'shake'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">void</span><span class="s1"> cliff</span><span class="s8">.</span><span class="s1">offsetWidth</span><span class="s8">;</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>cliff</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'shake'</span><span class="s8">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> hpRatio </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">/</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'crack-1'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> hpRatio </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.8</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'crack-2'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> hpRatio </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.6</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'crack-3'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> hpRatio </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.4</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'crack-4'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> hpRatio </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.2</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'crack-5'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> hpRatio </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s13">0.1</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>screenShake</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> body </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'game-body'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>body</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'screen-shake'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">void</span><span class="s1"> body</span><span class="s8">.</span><span class="s1">offsetWidth</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>body</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'screen-shake'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>addMoney</span><span class="s8">(</span><span class="s1">amount</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money </span><span class="s8">+=</span><span class="s1"> amount</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">maxMoney</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">maxMoney </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">checkTitleUpgrade</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>buyUpgrade</span><span class="s8">(</span><span class="s1">id</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> cost </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getUpgradeCost</span><span class="s8">(</span><span class="s1">id</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money </span><span class="s8">&gt;=</span><span class="s1"> cost</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money </span><span class="s8">-=</span><span class="s1"> cost</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">id</span><span class="s8">]++;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">renderShop</span><span class="s8">();</span><span class="s1"> </span><span class="s9">// ボタン状態更新</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">updateUI</span><span class="s8">();</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">// タップフィードバック</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">if</span><span class="s8">(</span><span class="s1">navigator</span><span class="s8">.</span><span class="s1">vibrate</span><span class="s8">)</span><span class="s1"> navigator</span><span class="s8">.</span><span class="s1">vibrate</span><span class="s8">(</span><span class="s13">50</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- UI &amp; Rendering ---</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>getCurrentTitleData</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> current </span><span class="s8">=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">[</span><span class="s13">0</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">let</span><span class="s1"> next </span><span class="s8">=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">[</span><span class="s13">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">for</span><span class="s1"> </span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span><span class="s1"> i </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">.</span><span class="s1">length</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">maxMoney </span><span class="s8">&gt;=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">[</span><span class="s1">i</span><span class="s8">].</span><span class="s1">threshold</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>current </span><span class="s8">=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">[</span><span class="s1">i</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>next </span><span class="s8">=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">[</span><span class="s1">i </span><span class="s8">+</span><span class="s1"> </span><span class="s13">1</span><span class="s8">]</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s7">null</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">return</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> current</span><span class="s8">,</span><span class="s1"> next </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>checkTitleUpgrade</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> current </span><span class="s8">}</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getCurrentTitleData</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">lastTitleId </span><span class="s8">!==</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">id</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s4">showToast</span><span class="s8">(</span><span class="s1">`ランクアップ！&lt;br&gt;&lt;span class="text-yellow-300 font-bold"&gt;</span><span class="s8">${</span><span class="s4">current</span><span class="s8">.</span><span class="s4">title</span><span class="s8">}</span><span class="s1">&lt;/span&gt;`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">lastTitleId </span><span class="s8">=</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">id</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">renderHistory</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>loop</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">autoIncome </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">addMoney</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">autoIncome </span><span class="s8">*</span><span class="s1"> </span><span class="s13">0.1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">updateUI</span><span class="s8">();</span><span class="s1"> </span><span class="s9">// 自動収入時の更新</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateUI</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// 数値更新</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'money-display'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money</span><span class="s8">).</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'gps-display'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">autoIncome</span><span class="s8">.</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'cpc-display'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">clickPower</span><span class="s8">.</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// HPバー</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> hpPercent </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">max</span><span class="s8">(</span><span class="s13">0</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">/</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'cliff-hp-bar'</span><span class="s8">).</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">hpPercent</span><span class="s8">}</span><span class="s14">%`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'hp-text'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP</span><span class="s8">).</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'max-hp-text'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP</span><span class="s8">).</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// 称号・ランク</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> current</span><span class="s8">,</span><span class="s1"> next </span><span class="s8">}</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getCurrentTitleData</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'title-display'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">title</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> titleEl </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'title-display'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">current</span><span class="s8">.</span><span class="s1">isPromotion</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>titleEl</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"text-sm md:text-lg font-serif font-bold text-yellow-400 truncate drop-shadow-md animate-pulse"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>titleEl</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"text-sm md:text-lg font-serif font-bold text-white truncate drop-shadow-md"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> bar </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'progress-bar'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">next</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> step </span><span class="s8">=</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> progress </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">maxMoney </span><span class="s8">%</span><span class="s1"> step</span><span class="s8">)</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> step </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> visualProgress </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">maxMoney </span><span class="s8">&gt;=</span><span class="s1"> next</span><span class="s8">.</span><span class="s1">threshold</span><span class="s8">)</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s13">100</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> progress</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>bar</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">visualProgress</span><span class="s8">}</span><span class="s14">%`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>bar</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'100%'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// ショップボタンのステータス更新 (軽量化のため間引いてもいいが、毎回チェック)</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">updateShopButtons</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>updateShopButtons</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> btn </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">`btn-buy-</span><span class="s8">${</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">}</span><span class="s14">`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">btn</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> cost </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getUpgradeCost</span><span class="s8">(</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> canBuy </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">money </span><span class="s8">&gt;=</span><span class="s1"> cost</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                        </span></span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s1">// クラス変更は状態が変わった時だけに行うのがベストだが、簡易実装</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">canBuy </span><span class="s8">&amp;&amp;</span><span class="s1"> btn</span><span class="s8">.</span><span class="s1">disabled</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">disabled </span><span class="s8">=</span><span class="s1"> </span><span class="s7">false</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'opacity-50'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'grayscale'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'active:scale-95'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s7">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">canBuy </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">!</span><span class="s1">btn</span><span class="s8">.</span><span class="s1">disabled</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">disabled </span><span class="s8">=</span><span class="s1"> </span><span class="s7">true</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'opacity-50'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'grayscale'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span>btn</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'active:scale-95'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>switchTab</span><span class="s8">(</span><span class="s1">tab</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> shop </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'shop-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> history </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'history-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> btnUpgrade </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'tab-upgrade'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> btnHistory </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'tab-history'</span><span class="s8">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">tab </span><span class="s8">===</span><span class="s1"> </span><span class="s14">'upgrade'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>shop</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>history</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnUpgrade</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'border-transparent'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'border-orange-500'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnUpgrade</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'text-slate-500'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'text-orange-400'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnHistory</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'border-orange-500'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'border-transparent'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnHistory</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'text-orange-400'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'text-slate-500'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>shop</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s14">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>history</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(</span><span class="s14">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnHistory</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'border-transparent'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'border-orange-500'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnHistory</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'text-slate-500'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'text-orange-400'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnUpgrade</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'border-orange-500'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'border-transparent'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btnUpgrade</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s14">'text-orange-400'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">'text-slate-500'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">renderHistory</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>initUI</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> shopContainer </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'shop-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>shopContainer</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s14">''</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> el </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>el</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"bg-black/20 mb-2 p-2 rounded-lg border border-orange-900/30 flex justify-between items-center"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">// スマホ用にレイアウト調整</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>el</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-1 min-w-0"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center gap-2"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="font-bold text-orange-200 text-sm truncate"&gt;</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">name</span><span class="s8">}</span><span class="s1">&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                                </span>&lt;span class="text-[10px] bg-black/40 px-1.5 py-0.5 rounded text-slate-400"&gt;Lv.&lt;span id="lvl-</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">}</span><span class="s1">"&gt;</span><span class="s8">${</span><span class="s7">this</span><span class="s8">.</span><span class="s4">state</span><span class="s8">.</span><span class="s4">upgrades</span><span class="s8">[</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">]}</span><span class="s1">&lt;/span&gt;&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="text-[10px] text-slate-500 truncate"&gt;</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">desc</span><span class="s8">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;div class="text-[10px] text-yellow-600 font-mono"&gt;効果: +</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">basePower</span><span class="s8">}</span><span class="s1"> </span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">type </span><span class="s8">===</span><span class="s4"> </span><span class="s1">'click'</span><span class="s4"> </span><span class="s8">?</span><span class="s4"> </span><span class="s1">'/打'</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'/秒'</span><span class="s8">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;button id="btn-buy-</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">}</span><span class="s1">" class="ml-2 w-20 py-2 bg-slate-800 border border-slate-600 rounded flex flex-col items-center justify-center transition-all tap-active" onclick="game.buyUpgrade('</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">}</span><span class="s1">')"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span class="text-[9px] text-slate-400"&gt;購入&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;span class="text-xs font-mono text-white font-bold"&gt;&lt;span id="cost-</span><span class="s8">${</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">}</span><span class="s1">"&gt;</span><span class="s8">${</span><span class="s7">this</span><span class="s8">.</span><span class="s4">getUpgradeCost</span><span class="s8">(</span><span class="s4">u</span><span class="s8">.</span><span class="s4">id</span><span class="s8">).</span><span class="s4">toLocaleString</span><span class="s8">()}</span><span class="s1">&lt;/span&gt;&lt;/span&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>shopContainer</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">el</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">// バブリング防止用</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> btn </span><span class="s8">=</span><span class="s1"> el</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s14">'button'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>btn</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s14">'pointerdown'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> e</span><span class="s8">.</span><span class="s1">stopPropagation</span><span class="s8">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderShop</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">UPGRADES</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">u </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">`lvl-</span><span class="s8">${</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">}</span><span class="s14">`</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">upgrades</span><span class="s8">[</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">`cost-</span><span class="s8">${</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">}</span><span class="s14">`</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getUpgradeCost</span><span class="s8">(</span><span class="s1">u</span><span class="s8">.</span><span class="s1">id</span><span class="s8">).</span><span class="s1">toLocaleString</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>renderHistory</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> list </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'history-list'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>list</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s14">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> current </span><span class="s8">}</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getCurrentTitleData</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> unlockedTitles </span><span class="s8">=</span><span class="s1"> </span><span class="s12">TITLE_DATA</span><span class="s8">.</span><span class="s1">filter</span><span class="s8">(</span><span class="s1">t </span><span class="s8">=&gt;</span><span class="s1"> t</span><span class="s8">.</span><span class="s1">id </span><span class="s8">&lt;=</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">id</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">[...</span><span class="s1">unlockedTitles</span><span class="s8">].</span><span class="s1">reverse</span><span class="s8">().</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">t </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> tr </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'tr'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>tr</span><span class="s8">.</span><span class="s1">className </span><span class="s8">=</span><span class="s1"> </span><span class="s14">"border-b border-white/5"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>tr</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="py-2 pl-2 w-1/4 truncate"&gt;</span><span class="s8">${</span><span class="s4">t</span><span class="s8">.</span><span class="s4">chapter</span><span class="s8">.</span><span class="s4">split</span><span class="s8">(</span><span class="s1">'：'</span><span class="s8">)[</span><span class="s13">0</span><span class="s8">]}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="py-2 w-1/2 </span><span class="s8">${</span><span class="s4">t</span><span class="s8">.</span><span class="s4">isPromotion </span><span class="s8">?</span><span class="s4"> </span><span class="s1">'text-yellow-400 font-bold'</span><span class="s4"> </span><span class="s8">:</span><span class="s4"> </span><span class="s1">'text-slate-300'</span><span class="s8">}</span><span class="s1">"&gt;</span><span class="s8">${</span><span class="s4">t</span><span class="s8">.</span><span class="s4">title</span><span class="s8">}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;td class="py-2 pr-2 text-right font-mono text-slate-500"&gt;</span><span class="s8">${</span><span class="s4">t</span><span class="s8">.</span><span class="s4">threshold</span><span class="s8">.</span><span class="s4">toLocaleString</span><span class="s8">()}</span><span class="s1">&lt;/td&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>list</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">tr</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- Effects ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnParticles</span><span class="s8">(</span><span class="s1">amount</span><span class="s8">,</span><span class="s1"> x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-effects'</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// 数字ポップアップ</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> text </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>text</span><span class="s8">.</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`+</span><span class="s8">${</span><span class="s1">amount</span><span class="s8">}</span><span class="s14">`</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>text</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"absolute text-yellow-400 font-bold font-mono text-lg pointer-events-none drop-shadow-md z-[60]"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// 散らばりすぎないように</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>text</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">x</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>text</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">y </span><span class="s8">-</span><span class="s1"> </span><span class="s13">30</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>text</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">transform </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`translate(-50%, 0)`</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">text</span><span class="s8">);</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> anim </span><span class="s8">=</span><span class="s1"> text</span><span class="s8">.</span><span class="s1">animate</span><span class="s8">([</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(-50%, 0) scale(1)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(-50%, -60px) scale(1.2)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">],</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> duration</span><span class="s8">:</span><span class="s1"> </span><span class="s13">600</span><span class="s8">,</span><span class="s1"> easing</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'ease-out'</span><span class="s1"> </span><span class="s8">});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>anim</span><span class="s8">.</span><span class="s1">onfinish </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> text</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// パーティクル（軽量化のため数減らす）</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i</span><span class="s8">=</span><span class="s13">0</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">&lt;</span><span class="s13">2</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> p </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"particle bg-yellow-500 w-1.5 h-1.5 rounded-sm absolute"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">x</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">y</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">setProperty</span><span class="s8">(</span><span class="s14">'--tx'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()-</span><span class="s13">0.5</span><span class="s8">)*</span><span class="s13">80</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">setProperty</span><span class="s8">(</span><span class="s14">'--ty'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s13">50</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()*</span><span class="s13">30</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">p</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">600</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 石辺（ボロボロ崩れ落ちる演出）</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnStoneFragments</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-effects'</span><span class="s8">);</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s1">// 数を増やして「ボロボロ感」を出す</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> count </span><span class="s8">=</span><span class="s1"> </span><span class="s13">6</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">5</span><span class="s8">);</span><span class="s1"><span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i</span><span class="s8">=</span><span class="s13">0</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">&lt;</span><span class="s1">count</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> p </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> size </span><span class="s8">=</span><span class="s1"> </span><span class="s13">2</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">4</span><span class="s8">;</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s4"> colors </span><span class="s8">=</span><span class="s4"> </span><span class="s8">[</span><span class="s1">'#a8a29e'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#78716c'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#5d4037'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#44403c'</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> color </span><span class="s8">=</span><span class="s1"> colors</span><span class="s8">[</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> colors</span><span class="s8">.</span><span class="s1">length</span><span class="s8">)];</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">position </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'absolute'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">pointerEvents </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'none'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">height </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">backgroundColor </span><span class="s8">=</span><span class="s1"> color</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">borderRadius </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'2px'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">x</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">y</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">zIndex </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'45'</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">// 下に落ちていくアニメーション</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> tx </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">40</span><span class="s8">;</span><span class="s1"> </span><span class="s9">// 少し横に広がる</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> ty </span><span class="s8">=</span><span class="s1"> </span><span class="s13">20</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">60</span><span class="s8">;</span><span class="s1"> <span class="Apple-converted-space">  </span></span><span class="s9">// 下に落ちる</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> rot </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">360</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">animate</span><span class="s8">([</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(0, 0) rotate(0deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(</span><span class="s8">${</span><span class="s1">tx</span><span class="s8">}</span><span class="s14">px, </span><span class="s8">${</span><span class="s1">ty</span><span class="s8">}</span><span class="s14">px) rotate(</span><span class="s8">${</span><span class="s1">rot</span><span class="s8">}</span><span class="s14">deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">],</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>duration</span><span class="s8">:</span><span class="s1"> </span><span class="s13">500</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">300</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>easing</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'ease-in'</span><span class="s8">,</span><span class="s1"> </span><span class="s9">// 重力加速っぽく</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>fill</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'forwards'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}).</span><span class="s1">onfinish </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">();</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">p</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// 大きな破片（たまに飛び散る）</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnBigFragment</span><span class="s8">(</span><span class="s1">x</span><span class="s8">,</span><span class="s1"> y</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-effects'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> p </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> size </span><span class="s8">=</span><span class="s1"> </span><span class="s13">8</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">8</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">className </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'rubble'</span><span class="s8">;</span><span class="s1"> </span><span class="s9">// 既存のスタイルを利用</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">height </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">x</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">y</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">backgroundColor </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'#4E342E'</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> tx </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">150</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> ty </span><span class="s8">=</span><span class="s1"> </span><span class="s13">100</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> rot </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">720</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s9">// ポーンと飛んで落ちる</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>p</span><span class="s8">.</span><span class="s1">animate</span><span class="s8">([</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(0, 0) scale(1) rotate(0deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(</span><span class="s8">${</span><span class="s1">tx </span><span class="s8">*</span><span class="s1"> </span><span class="s13">0.2</span><span class="s8">}</span><span class="s14">px, -20px) scale(1.1) rotate(</span><span class="s8">${</span><span class="s1">rot </span><span class="s8">*</span><span class="s1"> </span><span class="s13">0.2</span><span class="s8">}</span><span class="s14">deg)`</span><span class="s8">,</span><span class="s1"> offset</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0.3</span><span class="s1"> </span><span class="s8">},</span><span class="s1"> </span><span class="s9">// 一瞬跳ねる</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(</span><span class="s8">${</span><span class="s1">tx</span><span class="s8">}</span><span class="s14">px, </span><span class="s8">${</span><span class="s1">ty</span><span class="s8">}</span><span class="s14">px) scale(0.8) rotate(</span><span class="s8">${</span><span class="s1">rot</span><span class="s8">}</span><span class="s14">deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">],</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>duration</span><span class="s8">:</span><span class="s1"> </span><span class="s13">800</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>easing</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'ease-out'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>fill</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'forwards'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}).</span><span class="s1">onfinish </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">p</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnExplosion</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-effects'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                 </span></span><span class="s7">const</span><span class="s4"> colors </span><span class="s8">=</span><span class="s4"> </span><span class="s8">[</span><span class="s1">'#fbbf24'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#ef4444'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#3b82f6'</span><span class="s8">,</span><span class="s4"> </span><span class="s1">'#10b981'</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i</span><span class="s8">=</span><span class="s13">0</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">&lt;</span><span class="s13">12</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> p </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> color </span><span class="s8">=</span><span class="s1"> colors</span><span class="s8">[</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> colors</span><span class="s8">.</span><span class="s1">length</span><span class="s8">)];</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"particle w-3 h-3 rounded-full absolute border border-white/50"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">backgroundColor </span><span class="s8">=</span><span class="s1"> color</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s9">// 岩の中心から爆発</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`50%`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`40%`</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> angle </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s12">PI</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">2</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> speed </span><span class="s8">=</span><span class="s1"> </span><span class="s13">80</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">80</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">setProperty</span><span class="s8">(</span><span class="s14">'--tx'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">cos</span><span class="s8">(</span><span class="s1">angle</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> speed</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">setProperty</span><span class="s8">(</span><span class="s14">'--ty'</span><span class="s8">,</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">sin</span><span class="s8">(</span><span class="s1">angle</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> speed</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">p</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">800</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>spawnRubble</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'click-effects'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s7">for</span><span class="s8">(</span><span class="s7">let</span><span class="s1"> i</span><span class="s8">=</span><span class="s13">0</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">&lt;</span><span class="s13">10</span><span class="s8">;</span><span class="s1"> i</span><span class="s8">++)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> p </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">const</span><span class="s1"> size </span><span class="s8">=</span><span class="s1"> </span><span class="s13">6</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">12</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">className </span><span class="s8">=</span><span class="s1"> </span><span class="s14">"rubble"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">width </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">height </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span><span class="s8">${</span><span class="s1">size</span><span class="s8">}</span><span class="s14">px`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">left </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`calc(50% + </span><span class="s8">${(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">120</span><span class="s8">}</span><span class="s14">px)`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">top </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`calc(40% + </span><span class="s8">${(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">-</span><span class="s1"> </span><span class="s13">0.5</span><span class="s8">)</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">80</span><span class="s8">}</span><span class="s14">px)`</span><span class="s8">;</span></p>
<p class="p6"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>p</span><span class="s8">.</span><span class="s1">animate</span><span class="s8">([</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(0,0) rotate(0deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">1</span><span class="s1"> </span><span class="s8">},</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">{</span><span class="s1"> transform</span><span class="s8">:</span><span class="s1"> </span><span class="s14">`translate(</span><span class="s8">${(</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()-</span><span class="s13">0.5</span><span class="s8">)*</span><span class="s13">100</span><span class="s8">}</span><span class="s14">px, 500px) rotate(</span><span class="s8">${</span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()*</span><span class="s13">360</span><span class="s8">}</span><span class="s14">deg)`</span><span class="s8">,</span><span class="s1"> opacity</span><span class="s8">:</span><span class="s1"> </span><span class="s13">0</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">],</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>duration</span><span class="s8">:</span><span class="s1"> </span><span class="s13">800</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">random</span><span class="s8">()</span><span class="s1"> </span><span class="s8">*</span><span class="s1"> </span><span class="s13">400</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>easing</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'cubic-bezier(0.5, 0, 1, 1)'</span><span class="s8">,</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>fill</span><span class="s8">:</span><span class="s1"> </span><span class="s14">'forwards'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}).</span><span class="s1">onfinish </span><span class="s8">=</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">p</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// --- Menu &amp; Save ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>toggleMenu</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> modal </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'menu-modal'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> current </span><span class="s8">}</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">getCurrentTitleData</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'menu-chapter'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">chapter</span><span class="s8">.</span><span class="s1">match</span><span class="s8">(</span><span class="s15">/\d+/</span><span class="s8">)[</span><span class="s13">0</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'menu-title'</span><span class="s8">).</span><span class="s1">textContent </span><span class="s8">=</span><span class="s1"> current</span><span class="s8">.</span><span class="s1">title</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>modal</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">toggle</span><span class="s8">(</span><span class="s14">'hidden'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>showToast</span><span class="s8">(</span><span class="s1">html</span><span class="s8">,</span><span class="s1"> type </span><span class="s8">=</span><span class="s1"> </span><span class="s14">'info'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> container </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s14">'toast-container'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> el </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">createElement</span><span class="s8">(</span><span class="s14">'div'</span><span class="s8">);</span></p>
<p class="p5"><span class="s4"><span class="Apple-converted-space">                </span>el</span><span class="s8">.</span><span class="s4">className </span><span class="s8">=</span><span class="s4"> </span><span class="s1">"toast bg-slate-800/90 border border-yellow-500/50 text-white p-3 rounded-lg shadow-xl flex items-center gap-3 backdrop-blur-md"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>el</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s14">`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="text-xl"&gt;🎉&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;div class="text-sm font-bold text-center flex-1"&gt;</span><span class="s8">${</span><span class="s4">html</span><span class="s8">}</span><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span>`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>container</span><span class="s8">.</span><span class="s1">appendChild</span><span class="s8">(</span><span class="s1">el</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>el</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">transition </span><span class="s8">=</span><span class="s1"> </span><span class="s14">"opacity 0.3s, transform 0.3s"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>el</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">opacity </span><span class="s8">=</span><span class="s1"> </span><span class="s13">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>el</span><span class="s8">.</span><span class="s1">style</span><span class="s8">.</span><span class="s1">transform </span><span class="s8">=</span><span class="s1"> </span><span class="s14">"translate(0, -20px)"</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> el</span><span class="s8">.</span><span class="s1">remove</span><span class="s8">(),</span><span class="s1"> </span><span class="s13">300</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">},</span><span class="s1"> </span><span class="s13">3000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>save</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">lastSaveTime </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Date</span><span class="s8">.</span><span class="s1">now</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>localStorage</span><span class="s8">.</span><span class="s1">setItem</span><span class="s8">(</span><span class="s14">'cliffMobileSave'</span><span class="s8">,</span><span class="s1"> </span><span class="s12">JSON</span><span class="s8">.</span><span class="s1">stringify</span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>load</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">const</span><span class="s1"> saved </span><span class="s8">=</span><span class="s1"> localStorage</span><span class="s8">.</span><span class="s1">getItem</span><span class="s8">(</span><span class="s14">'cliffMobileSave'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">saved</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s7">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> parsed </span><span class="s8">=</span><span class="s1"> </span><span class="s12">JSON</span><span class="s8">.</span><span class="s1">parse</span><span class="s8">(</span><span class="s1">saved</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">state </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s8">...</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">,</span><span class="s1"> </span><span class="s8">...</span><span class="s1">parsed </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">// データ不整合防止</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s8">(!</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP</span><span class="s8">)</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffHP </span><span class="s8">=</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s8">(!</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP</span><span class="s8">)</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">cliffMaxHP </span><span class="s8">=</span><span class="s1"> </span><span class="s13">100</span><span class="s8">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> now </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Date</span><span class="s8">.</span><span class="s1">now</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">const</span><span class="s1"> secondsOffline </span><span class="s8">=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">now </span><span class="s8">-</span><span class="s1"> </span><span class="s8">(</span><span class="s7">this</span><span class="s8">.</span><span class="s1">state</span><span class="s8">.</span><span class="s1">lastSaveTime </span><span class="s8">||</span><span class="s1"> now</span><span class="s8">))</span><span class="s1"> </span><span class="s8">/</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s9">// オフライン収入</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">secondsOffline </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">10</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">const</span><span class="s1"> offlineGain </span><span class="s8">=</span><span class="s1"> </span><span class="s12">Math</span><span class="s8">.</span><span class="s1">floor</span><span class="s8">(</span><span class="s1">secondsOffline </span><span class="s8">*</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">autoIncome</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s7">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">offlineGain </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s13">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span></span><span class="s7">this</span><span class="s8">.</span><span class="s1">addMoney</span><span class="s8">(</span><span class="s1">offlineGain</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                                </span>setTimeout</span><span class="s8">(()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s7">this</span><span class="s8">.</span><span class="s1">showToast</span><span class="s8">(</span><span class="s14">`オフライン収益&lt;br&gt;&lt;span class="text-green-400 font-mono"&gt;+</span><span class="s8">${</span><span class="s1">offlineGain</span><span class="s8">.</span><span class="s1">toLocaleString</span><span class="s8">()}</span><span class="s14"> G&lt;/span&gt;`</span><span class="s8">),</span><span class="s1"> </span><span class="s13">1000</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span><span class="s1"> </span><span class="s7">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s14">"Save data corrupted"</span><span class="s8">,</span><span class="s1"> e</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>resetSave</span><span class="s8">()</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s7">if</span><span class="s8">(</span><span class="s1">confirm</span><span class="s8">(</span><span class="s14">"データを初期化しますか？"</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>localStorage</span><span class="s8">.</span><span class="s1">removeItem</span><span class="s8">(</span><span class="s14">'cliffMobileSave'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>location</span><span class="s8">.</span><span class="s1">reload</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s7">const</span><span class="s1"> game </span><span class="s8">=</span><span class="s1"> </span><span class="s7">new</span><span class="s1"> </span><span class="s12">Game</span><span class="s8">();</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
</body>
</html>
